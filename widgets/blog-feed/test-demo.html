<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog Feed Widget Test</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; margin: 0; padding: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; }
        h1 { color: #333; margin-bottom: 30px; }
        
        /* Blog Feed Styles - Single Column Layout */
        #blogFeed { margin: 20px 0; }
        
        .blog-feed {
            max-width: 800px;
            margin: 0 auto;
            padding: 0;
        }
        
        .blog-card {
            background: #fff;
            border-radius: 1rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            overflow: hidden;
            margin-bottom: 3rem;
            transition: all 0.3s ease;
        }
        
        .blog-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }
        
        .blog-card-header { padding: 2rem 2rem 0 2rem; }
        .blog-title { margin: 0 0 0.75rem 0; font-size: 1.75rem; font-weight: 700; color: #000; line-height: 1.3; }
        .blog-date { display: inline-block; color: #999; font-size: 0.9rem; font-weight: 500; margin-bottom: 1.5rem; text-transform: uppercase; letter-spacing: 0.5px; }
        .blog-body { padding: 0 2rem 2rem 2rem; color: #333; line-height: 1.7; font-size: 1rem; }
        .blog-body p { margin: 0 0 1rem 0; }
        .blog-body h2, .blog-body h3 { margin: 1.5rem 0 0.75rem 0; color: #000; font-weight: 600; }
        .blog-body ul, .blog-body ol { margin: 0.75rem 0; padding-left: 1.25rem; }
        .blog-body a { color: #000; text-decoration: underline; transition: opacity 0.2s ease; }
        .blog-body a:hover { opacity: 0.7; }
        
        .blog-image { margin: 0; position: relative; }
        .blog-image img { width: 100%; height: 300px; object-fit: cover; display: block; transition: transform 0.3s ease; }
        .blog-card:hover .blog-image img { transform: scale(1.01); }
        .blog-image-caption { font-size: 0.85rem; color: #999; padding: 0.5rem 0.75rem; font-style: italic; background: rgba(0,0,0,0.02); border-top: 1px solid rgba(0,0,0,0.05); }
        
        .blog-loading, .blog-error { padding: 3rem 1.5rem; text-align: center; color: #666; background: #fff; border-radius: 1rem; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        .blog-error { color: #d73027; background: #fef7f7; border: 1px solid rgba(215,48,39,0.1); }
        
        @media (max-width: 768px) {
            .blog-feed { max-width: 95%; }
            .blog-card-header { padding: 1.5rem 1.5rem 0 1.5rem; }
            .blog-body { padding: 0 1.5rem 1.5rem 1.5rem; }
            .blog-title { font-size: 1.5rem; }
            .blog-image img { height: 250px; }
        }
        
        /* Debug Info */
        .debug-info { background: #fff; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #007bff; }
        .debug-info h3 { margin: 0 0 10px 0; color: #007bff; }
        .debug-info code { background: #f8f9fa; padding: 2px 6px; border-radius: 3px; font-size: 0.9em; }
        .debug-info pre { background: #f8f9fa; padding: 12px; border-radius: 4px; overflow-x: auto; font-size: 0.8em; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Blog Feed Widget Test</h1>
        
        <div class="debug-info">
            <h3>Setup Instructions:</h3>
            <ol>
                <li>Create a Google Sheet with these columns: <code>Title</code>, <code>Date</code>, <code>Image</code>, <code>Body</code></li>
                <li>Add some test data (see example below)</li>
                <li>Share the sheet: <strong>Anyone with the link can view</strong></li>
                <li>Copy the Sheet ID from the URL (the long string between <code>/d/</code> and <code>/edit</code>)</li>
                <li>Replace <code>YOUR_SHEET_ID</code> in the HTML below</li>
            </ol>
            
            <h3>Example Sheet Data:</h3>
            <pre>Title                    | Date       | Image                              | Body
My First Blog Post       | 2025-01-15 | https://picsum.photos/400/300?1   | This is my first blog post with some <strong>HTML</strong> content.
Photography Tips         | 2025-01-10 | https://picsum.photos/400/300?2   | Here are some tips for better photography...
Recent Project Update    | 2025-01-05 | https://picsum.photos/400/300?3   | Our latest project is making great progress!</pre>
        </div>

        <!-- Blog Feed Widget -->
        <div id="blogFeed" data-blog-feed data-provider="sheets"
             data-sheet-id="YOUR_SHEET_ID" 
             data-sheet-name="Sheet1" 
             data-max-posts="5"
             data-show-dates="true" 
             data-show-images="true" 
             data-auto-captions="true">
            <div class="blog-loading">Loading blog posts...</div>
        </div>

        <div class="debug-info">
            <h3>Troubleshooting:</h3>
            <ul>
                <li>Getting 404 error? Check that your Google Sheet is shared publicly</li>
                <li>No posts showing? Verify your column names match: Title, Date, Image, Body</li>
                <li>Still having issues? Check the browser console for error details</li>
            </ul>
            
            <h3>Test URLs:</h3>
            <p>You can test the Google Sheets API directly by visiting:</p>
            <code id="testUrl">https://docs.google.com/spreadsheets/d/YOUR_SHEET_ID/gviz/tq?tqx=out:json&sheet=Sheet1</code>
            
            <p><small>Replace YOUR_SHEET_ID with your actual sheet ID</small></p>
        </div>
    </div>

    <!-- Load the scripts -->
    <script src="../shared/universal-caption-system.js"></script>
    <script src="./blog-feed.js"></script>

    <script>
        // Add some debugging
        console.log('Blog Feed Widget Test Page Loaded');
        
        // Listen for any errors
        window.addEventListener('error', (e) => {
            console.error('Page Error:', e.error);
        });
        
        // Monitor the blog feed container for changes
        const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
                if (mutation.target.id === 'blogFeed') {
                    console.log('Blog feed updated:', mutation.target.innerHTML.slice(0, 100) + '...');
                }
            });
        });
        
        observer.observe(document.getElementById('blogFeed'), {
            childList: true,
            subtree: true
        });

        // Update test URL dynamically
        const urlElement = document.getElementById('testUrl');
        const blogFeed = document.getElementById('blogFeed');
        const sheetId = blogFeed.dataset.sheetId;
        const sheetName = blogFeed.dataset.sheetName || 'Sheet1';
        
        if (sheetId && sheetId !== 'YOUR_SHEET_ID') {
            urlElement.textContent = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${sheetName}`;
            urlElement.innerHTML = `<a href="${urlElement.textContent}" target="_blank">${urlElement.textContent}</a>`;
        }
    </script>
</body>
</html>